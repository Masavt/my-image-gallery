<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forbidden Stories - AIè‡ªå‹•ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ç”Ÿæˆ</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            background: #1a1a1a;
            color: #fff;
            font-family: 'Georgia', serif;
            line-height: 1.6;
        }
        .header {
            background: linear-gradient(135deg, #8B0000 0%, #000000 100%);
            padding: 30px;
            text-align: center;
            border-bottom: 2px solid #8B0000;
        }
        .header h1 {
            font-size: 3em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            letter-spacing: 3px;
        }
        .tagline {
            font-style: italic;
            opacity: 0.8;
            margin-top: 10px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        /* ã‚¸ãƒ£ãƒ³ãƒ«é¸æŠ */
        .genre-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .genre-card {
            background: #2a2a2a;
            border: 1px solid #8B0000;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        .genre-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(139, 0, 0, 0.5);
        }
        .genre-card.selected {
            background: #8B0000;
        }
        .genre-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }
        
        /* ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã‚ªãƒ—ã‚·ãƒ§ãƒ³ */
        .customization {
            background: #2a2a2a;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
        }
        .slider-group {
            margin: 20px 0;
        }
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .slider {
            width: 100%;
            height: 10px;
            border-radius: 5px;
            background: #444;
            outline: none;
            -webkit-appearance: none;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #8B0000;
            cursor: pointer;
        }
        
        /* ç”Ÿæˆãƒœã‚¿ãƒ³ */
        .generate-btn {
            background: linear-gradient(135deg, #8B0000 0%, #DC143C 100%);
            color: white;
            border: none;
            padding: 20px 60px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            display: block;
            margin: 40px auto;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .generate-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(220, 20, 60, 0.5);
        }
        
        /* ã‚¹ãƒˆãƒ¼ãƒªãƒ¼è¡¨ç¤º */
        .story-viewer {
            background: #000;
            border-radius: 10px;
            padding: 20px;
            margin-top: 40px;
            display: none;
        }
        .story-viewer.active {
            display: block;
        }
        .scene {
            margin-bottom: 40px;
            opacity: 0;
            animation: fadeIn 1s forwards;
        }
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        .scene-image {
            width: 100%;
            max-width: 800px;
            height: 400px;
            object-fit: cover;
            border-radius: 10px;
            margin: 0 auto 20px;
            display: block;
            filter: contrast(1.1) saturate(0.9);
        }
        .scene-text {
            max-width: 800px;
            margin: 0 auto;
            font-size: 1.2em;
            line-height: 1.8;
            text-align: justify;
            padding: 20px;
            background: rgba(139, 0, 0, 0.1);
            border-left: 3px solid #8B0000;
        }
        .scene-number {
            color: #8B0000;
            font-size: 0.9em;
            margin-bottom: 10px;
        }
        
        /* ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }
        .loading.active {
            display: block;
        }
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #8B0000;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* è­¦å‘Šè¡¨ç¤º */
        .warning {
            background: #8B0000;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 30px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Forbidden Stories</h1>
        <p class="tagline">AIãŒç´¡ãã€ã‚ãªãŸã ã‘ã®å®˜èƒ½çš„ãªç‰©èª</p>
    </div>

    <div class="container">
        <div class="warning">
            âš ï¸ ã“ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯18æ­³ä»¥ä¸Šã®æ–¹ã®ã¿å¯¾è±¡ã§ã™ã€‚AIã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚ŒãŸæ¶ç©ºã®ç‰©èªã§ã™ã€‚
        </div>

        <!-- ã‚¸ãƒ£ãƒ³ãƒ«é¸æŠ -->
        <h2 style="text-align: center; margin-bottom: 30px;">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚¸ãƒ£ãƒ³ãƒ«ã‚’é¸æŠ</h2>
        <div class="genre-selector">
            <div class="genre-card" onclick="selectGenre('forbidden')">
                <div class="genre-icon">ğŸ”¥</div>
                <h3>ç¦æ–­ã®é–¢ä¿‚</h3>
                <p>è¨±ã•ã‚Œãªã„æ‹ã®ç‰©èª</p>
            </div>
            <div class="genre-card" onclick="selectGenre('dominant')">
                <div class="genre-icon">â›“ï¸</div>
                <h3>æ”¯é…ã¨æœå¾“</h3>
                <p>æ–°ãŸãªä¸–ç•Œã¸ã®æ‰‰</p>
            </div>
            <div class="genre-card" onclick="selectGenre('secret')">
                <div class="genre-icon">ğŸŒ™</div>
                <h3>ç§˜å¯†ã®é–¢ä¿‚</h3>
                <p>èª°ã«ã‚‚è¨€ãˆãªã„äºŒäººã ã‘ã®æ™‚é–“</p>
            </div>
            <div class="genre-card" onclick="selectGenre('transformation')">
                <div class="genre-icon">ğŸ¦‹</div>
                <h3>å¤‰åŒ–ã¨è¦šé†’</h3>
                <p>æ–°ã—ã„è‡ªåˆ†ã¨ã®å‡ºä¼šã„</p>
            </div>
        </div>

        <!-- ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã‚ªãƒ—ã‚·ãƒ§ãƒ³ -->
        <div class="customization">
            <h3 style="margin-bottom: 20px;">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º</h3>
            
            <div class="slider-group">
                <div class="slider-label">
                    <span>å¼·åº¦</span>
                    <span id="intensityValue">5</span>
                </div>
                <input type="range" class="slider" id="intensity" min="1" max="10" value="5">
            </div>
            
            <div class="slider-group">
                <div class="slider-label">
                    <span>ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã®é•·ã•</span>
                    <span id="lengthValue">4ã‚·ãƒ¼ãƒ³</span>
                </div>
                <input type="range" class="slider" id="storyLength" min="3" max="8" value="4">
            </div>
            
            <div class="slider-group">
                <div class="slider-label">
                    <span>ç”»åƒã‚¹ã‚¿ã‚¤ãƒ«</span>
                    <span id="styleValue">ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒ†ã‚£ãƒƒã‚¯</span>
                </div>
                <select id="imageStyle" style="width: 100%; padding: 10px; background: #444; color: white; border: none; border-radius: 5px;">
                    <option value="artistic">ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒ†ã‚£ãƒƒã‚¯</option>
                    <option value="realistic">ãƒªã‚¢ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯</option>
                    <option value="vintage">ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸</option>
                    <option value="noir">ãƒãƒ¯ãƒ¼ãƒ«</option>
                </select>
            </div>
        </div>

        <button class="generate-btn" onclick="generateStory()">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç”Ÿæˆ</button>

        <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º -->
        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <p>ã‚ãªãŸã ã‘ã®ç‰©èªã‚’ç”Ÿæˆä¸­...</p>
        </div>

        <!-- ã‚¹ãƒˆãƒ¼ãƒªãƒ¼è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
        <div class="story-viewer" id="storyViewer"></div>
    </div>

    <script>
        let selectedGenre = null;

        // ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆæ‹¡å¼µç‰ˆï¼‰
        const storyTemplates = {
            forbidden: {
                title: "ç¦æ–­ã®é–¢ä¿‚",
                scenes: [
                    {
                        text: "ãã®å‡ºä¼šã„ã¯å¶ç„¶ã ã£ãŸã€‚é›¨ã®é™ã‚‹å¤œã€é¿é›£ã—ãŸå¤ã„å›³æ›¸é¤¨ã§ã€ç§ãŸã¡ã¯é‹å‘½çš„ã«å‡ºä¼šã£ãŸã€‚å½¼å¥³ã®æ¿¡ã‚ŒãŸé«ªãŒã€è–„æš—ã„ç…§æ˜ã®ä¸‹ã§è‰¶ã‚ã„ã¦ã„ãŸã€‚",
                        mood: "mysterious",
                        imagePrompt: "dark library, rain, mysterious atmosphere"
                    },
                    {
                        text: "ç†æ€§ã§ã¯åˆ†ã‹ã£ã¦ã„ã‚‹ã€‚ã“ã®æ„Ÿæƒ…ã¯è¨±ã•ã‚Œãªã„ã‚‚ã®ã ã¨ã€‚ã—ã‹ã—ã€å½¼å¥³ã®å”‡ãŒå¾®ã‹ã«éœ‡ãˆã‚‹ã®ã‚’è¦‹ãŸæ™‚ã€ç§ã®ä¸­ã®ä½•ã‹ãŒå£Šã‚ŒãŸã€‚ã‚‚ã†ã€æŠ‘ãˆã‚‹ã“ã¨ã¯ã§ããªã„ã€‚",
                        mood: "conflicted",
                        imagePrompt: "emotional conflict, forbidden desire"
                    },
                    {
                        text: "æœˆæ˜ã‹ã‚Šã®ä¸‹ã€ã¤ã„ã«ç§ãŸã¡ã¯ä¸€ç·šã‚’è¶ŠãˆãŸã€‚å½¼å¥³ã®è‚Œã¯æœˆå…‰ã«ç…§ã‚‰ã•ã‚Œã¦çœŸç ã®ã‚ˆã†ã«è¼ã„ã¦ã„ãŸã€‚ã“ã®ç¬é–“ã‹ã‚‰ã€ã‚‚ã†å¾Œæˆ»ã‚Šã¯ã§ããªã„ã€‚",
                        mood: "passionate",
                        imagePrompt: "moonlight, intimate moment"
                    },
                    {
                        text: "æœæ—¥ãŒæ˜‡ã‚‹ã€‚ä¹±ã‚ŒãŸã‚·ãƒ¼ãƒ„ã®é–“ã‹ã‚‰å·®ã—è¾¼ã‚€å…‰ãŒã€æ–°ã—ã„ä¸€æ—¥ã®å§‹ã¾ã‚Šã‚’å‘Šã’ã¦ã„ãŸã€‚å½¼å¥³ã®å¯é¡”ã‚’è¦‹ã¤ã‚ãªãŒã‚‰ã€ã“ã‚Œã‹ã‚‰ã®é–¢ä¿‚ã«ã¤ã„ã¦è€ƒãˆãšã«ã¯ã„ã‚‰ã‚Œãªã‹ã£ãŸã€‚",
                        mood: "hopeful",
                        imagePrompt: "sunrise, new beginning"
                    }
                ]
            },
            dominant: {
                title: "æ”¯é…ã¨æœå¾“",
                scenes: [
                    {
                        text: "å¥‘ç´„æ›¸ã«ã‚µã‚¤ãƒ³ã‚’ã™ã‚‹æ‰‹ãŒéœ‡ãˆã¦ã„ãŸã€‚èµ¤ã„ãƒ­ã‚¦ã‚½ã‚¯ã®ç¯ã‚ŠãŒæºã‚‰ã‚ãéƒ¨å±‹ã§ã€ã“ã‚Œã‹ã‚‰å§‹ã¾ã‚‹æ–°ã—ã„ä¸–ç•Œã¸ã®æ‰‰ãŒé–‹ã‹ã‚Œã‚ˆã†ã¨ã—ã¦ã„ãŸã€‚",
                        mood: "anticipation",
                        imagePrompt: "contract signing, candlelight, anticipation"
                    },
                    {
                        text: "æœ€åˆã®ãƒ¬ãƒƒã‚¹ãƒ³ã€‚é©ã®æ„Ÿè§¦ã€å†·ãŸã„é‡‘å±ã®é‡ã¿ã€‚ä»Šã¾ã§çŸ¥ã‚‰ãªã‹ã£ãŸæ„Ÿè¦šãŒã€æ¬¡ã€…ã¨ç§ã‚’è¥²ã†ã€‚ææ€–ã¨æœŸå¾…ãŒå…¥ã‚Šæ··ã˜ã‚Šã€ä½“ãŒå°åˆ»ã¿ã«éœ‡ãˆãŸã€‚",
                        mood: "discovery",
                        imagePrompt: "first lesson, leather and metal"
                    },
                    {
                        text: "æŠµæŠ—ã¨å—å®¹ã®é–“ã§æºã‚Œå‹•ãå¿ƒã€‚ç¸›ã‚‰ã‚ŒãŸæ‰‹é¦–ã®ç—›ã¿ãŒã€ãªãœã‹ç”˜ç¾ãªå¿«æ¥½ã¸ã¨å¤‰ã‚ã£ã¦ã„ãã€‚ã“ã®æ„Ÿè¦šã¯ä¸€ä½“ä½•ãªã®ã‹ã€‚ç§ã¯æœ¬å½“ã«ã€ã“ã‚Œã‚’æ±‚ã‚ã¦ã„ãŸã®ã‹ã€‚",
                        mood: "acceptance",
                        imagePrompt: "bondage, internal struggle"
                    },
                    {
                        text: "å®Œå…¨ãªä¿¡é ¼é–¢ä¿‚ã®ä¸­ã§ã€çœŸã®è‡ªç”±ã‚’è¦‹ã¤ã‘ãŸã€‚æ”¯é…ã¨æœå¾“ã¯ã€ãŠäº’ã„ã‚’è§£æ”¾ã™ã‚‹éµã ã£ãŸã€‚æ¶™ã¨å…±ã«æµã‚Œå‡ºãŸã®ã¯ã€ä»Šã¾ã§ã®è‡ªåˆ†ã‚’ç¸›ã£ã¦ã„ãŸå…¨ã¦ã®æ·ã ã£ãŸã€‚",
                        mood: "liberation",
                        imagePrompt: "trust, tears of liberation"
                    }
                ]
            },
            secret: {
                title: "ç§˜å¯†ã®é–¢ä¿‚",
                scenes: [
                    {
                        text: "æ˜¼é–“ã¯æ™®é€šã®åŒåƒšã€‚ã§ã‚‚ã€ã‚ªãƒ•ã‚£ã‚¹ã®æ‰‰ãŒé–‰ã¾ã£ãŸå¾Œã®ç§ãŸã¡ã¯é•ã†ã€‚èª°ã‚‚ã„ãªã„ä¼šè­°å®¤ã§äº¤ã‚ã—ãŸæœ€åˆã®ã‚­ã‚¹ã®å‘³ã¯ã€ä»Šã§ã‚‚å¿˜ã‚Œã‚‰ã‚Œãªã„ã€‚",
                        mood: "secretive",
                        imagePrompt: "empty office, secret kiss"
                    },
                    {
                        text: "ãƒ›ãƒ†ãƒ«ã®ä¸€å®¤ã€‚å½åã§äºˆç´„ã—ãŸéƒ¨å±‹ã§ã€ç§ãŸã¡ã¯æœ¬å½“ã®è‡ªåˆ†ã«ãªã‚Œã‚‹ã€‚å¤–ã®ä¸–ç•Œã‹ã‚‰åˆ‡ã‚Šé›¢ã•ã‚ŒãŸã“ã®ç©ºé–“ã ã‘ãŒã€ç§ãŸã¡ã®è–åŸŸã ã£ãŸã€‚",
                        mood: "hidden",
                        imagePrompt: "hotel room, secret lovers"
                    },
                    {
                        text: "å½¼ã®æ‰‹ãŒç§ã®ç´ è‚Œã‚’é€™ã†ã€‚ã‚«ãƒ¼ãƒ†ãƒ³ã®éš™é–“ã‹ã‚‰æ¼ã‚Œã‚‹è¡—ã®ç¯ã‚ŠãŒã€ç§ãŸã¡ã®ç§˜å¯†ã‚’é™ã‹ã«è¦‹å®ˆã£ã¦ã„ãŸã€‚ã“ã®é–¢ä¿‚ãŒã„ã¤ã¾ã§ç¶šãã‹åˆ†ã‹ã‚‰ãªã„ã€‚ã ã‹ã‚‰ã“ãã€ä»Šã“ã®ç¬é–“ãŒæ„›ãŠã—ã„ã€‚",
                        mood: "intimate",
                        imagePrompt: "city lights through curtains"
                    },
                    {
                        text: "æœã«ãªã‚Œã°ã€ã¾ãŸä»–äººã®ãµã‚Šã‚’ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ã§ã‚‚ã€è‚Œã«æ®‹ã‚‹å½¼ã®æ¸©ã‚‚ã‚ŠãŒã€ã“ã‚ŒãŒå¤¢ã§ã¯ãªã„ã“ã¨ã‚’æ•™ãˆã¦ãã‚Œã‚‹ã€‚æ¬¡ã®é€¢ç€¬ã¾ã§ã€ã“ã®è¨˜æ†¶ã‚’å¤§åˆ‡ã«æŠ±ãã—ã‚ã¦ã„ã‚ˆã†ã€‚",
                        mood: "bittersweet",
                        imagePrompt: "morning after, secret memories"
                    }
                ]
            },
            transformation: {
                title: "å¤‰åŒ–ã¨è¦šé†’",
                scenes: [
                    {
                        text: "é¡ã«æ˜ ã‚‹è‡ªåˆ†ãŒã€ã¾ã‚‹ã§ä»–äººã®ã‚ˆã†ã«è¦‹ãˆãŸã€‚æ–°ã—ã„ä¸‹ç€ã€åˆã‚ã¦ã®ãƒ¡ã‚¤ã‚¯ã€‚ä»Šæ—¥ã‹ã‚‰ç§ã¯ã€é•ã†ç§ã«ãªã‚‹ã€‚",
                        mood: "nervous",
                        imagePrompt: "mirror reflection, transformation"
                    },
                    {
                        text: "ã‚¯ãƒ©ãƒ–ã®é‡ä½éŸ³ãŒä½“ã‚’éœ‡ã‚ã›ã‚‹ã€‚çŸ¥ã‚‰ãªã„äººãŸã¡ã®è¦–ç·šã‚’æ„Ÿã˜ãªãŒã‚‰ã€ç§ã¯å°‘ã—ãšã¤æ®»ã‚’ç ´ã£ã¦ã„ãã€‚ã“ã®æ„Ÿè¦šã¯...æ‚ªããªã„ã€‚",
                        mood: "exciting",
                        imagePrompt: "nightclub, dancing, liberation"
                    },
                    {
                        text: "åˆã‚ã¦èª°ã‹ã«è§¦ã‚Œã‚‰ã‚ŒãŸæ™‚ã€é›»æµãŒèµ°ã£ãŸã‚ˆã†ãªæ„Ÿè¦šã«è¥²ã‚ã‚ŒãŸã€‚ä»Šã¾ã§çœ ã£ã¦ã„ãŸä½•ã‹ãŒã€ã‚†ã£ãã‚Šã¨ç›®è¦šã‚å§‹ã‚ã‚‹ã€‚ç§ã®ä¸­ã«ã¯ã€ã“ã‚“ãªç§ã‚‚ã„ãŸã®ã‹ã€‚",
                        mood: "awakening",
                        imagePrompt: "first touch, awakening sensation"
                    },
                    {
                        text: "æœæ—¥ã‚’æµ´ã³ãªãŒã‚‰ã€æ˜¨å¤œã®å‡ºæ¥äº‹ã‚’æ€ã„è¿”ã™ã€‚æ¥ãšã‹ã—ã•ã¯ãªã„ã€‚ã‚ã‚‹ã®ã¯ã€æ–°ã—ã„è‡ªåˆ†ã‚’è¦‹ã¤ã‘ãŸå–œã³ã ã‘ã€‚ã“ã‚ŒãŒæœ¬å½“ã®ç§ãªã®ã‹ã‚‚ã—ã‚Œãªã„ã€‚",
                        mood: "confident",
                        imagePrompt: "morning light, new confidence"
                    }
                ]
            }
        };

        // ã‚ˆã‚Šå®˜èƒ½çš„ãªã‚µãƒ³ãƒ—ãƒ«ç”»åƒ
        const sampleImages = [
            "https://images.unsplash.com/photo-1516589178581-6cd7833ae3b2?w=800&q=80",
            "https://images.unsplash.com/photo-1519699047748-de8e457a634e?w=800&q=80",
            "https://images.unsplash.com/photo-1502716119720-b23a93e5fe1b?w=800&q=80",
            "https://images.unsplash.com/photo-1515191107209-c28698631303?w=800&q=80",
            "https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=800&q=80",
            "https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=800&q=80",
            "https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=800&q=80",
            "https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?w=800&q=80"
        ];

        // ã‚¸ãƒ£ãƒ³ãƒ«é¸æŠ
        function selectGenre(genre) {
            selectedGenre = genre;
            document.querySelectorAll('.genre-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.closest('.genre-card').classList.add('selected');
        }

        // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼å€¤ã®æ›´æ–°
        document.getElementById('intensity').oninput = function() {
            document.getElementById('intensityValue').textContent = this.value;
        };

        document.getElementById('storyLength').oninput = function() {
            document.getElementById('lengthValue').textContent = this.value + 'ã‚·ãƒ¼ãƒ³';
        };

        // ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ç”Ÿæˆ
        async function generateStory() {
            if (!selectedGenre) {
                alert('ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚¸ãƒ£ãƒ³ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„');
                return;
            }

            const loading = document.getElementById('loading');
            const viewer = document.getElementById('storyViewer');
            
            loading.classList.add('active');
            viewer.classList.remove('active');
            viewer.innerHTML = '';

            // æ“¬ä¼¼çš„ãªé…å»¶ï¼ˆå®Ÿéš›ã¯APIå‘¼ã³å‡ºã—ï¼‰
            await new Promise(resolve => setTimeout(resolve, 3000));

            const template = storyTemplates[selectedGenre] || storyTemplates.forbidden;
            const intensity = document.getElementById('intensity').value;
            const length = parseInt(document.getElementById('storyLength').value);

            // ã‚¹ãƒˆãƒ¼ãƒªãƒ¼è¡¨ç¤º
            viewer.innerHTML = `<h2 style="text-align: center; margin-bottom: 40px;">${template.title}</h2>`;

            // å¼·åº¦ã«å¿œã˜ã¦ãƒ†ã‚­ã‚¹ãƒˆã‚’èª¿æ•´ï¼ˆãƒ‡ãƒ¢ç‰ˆï¼‰
            const intensityMultiplier = intensity / 5; // 5ãŒæ¨™æº–

            for (let i = 0; i < Math.min(length, template.scenes.length); i++) {
                const scene = template.scenes[i];
                const sceneDiv = document.createElement('div');
                sceneDiv.className = 'scene';
                sceneDiv.style.animationDelay = `${i * 0.5}s`;
                
                // ãƒ©ãƒ³ãƒ€ãƒ ã«ç”»åƒã‚’é¸æŠï¼ˆå®Ÿéš›ã¯AIç”Ÿæˆï¼‰
                const imageUrl = sampleImages[Math.floor(Math.random() * sampleImages.length)];
                
                // å¼·åº¦ã«å¿œã˜ã¦ãƒ†ã‚­ã‚¹ãƒˆã‚’èª¿æ•´ï¼ˆå®Ÿéš›ã¯AIã§ç”Ÿæˆï¼‰
                let adjustedText = scene.text;
                if (intensityMultiplier > 1.5) {
                    adjustedText = scene.text + " ç†±ã„åæ¯ãŒéƒ¨å±‹ã«æº€ã¡ã¦ã„ãã€‚";
                } else if (intensityMultiplier < 0.5) {
                    adjustedText = scene.text.replace(/è‚Œ|å”‡|ä½“/g, "å¿ƒ");
                }
                
                sceneDiv.innerHTML = `
                    <div class="scene-number">Scene ${i + 1}</div>
                    <img src="${imageUrl}" alt="Scene ${i + 1}" class="scene-image" style="filter: contrast(${0.8 + intensityMultiplier * 0.2}) saturate(${0.8 + intensityMultiplier * 0.2})">
                    <div class="scene-text">${adjustedText}</div>
                `;
                
                viewer.appendChild(sceneDiv);
            }

            // ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°è¿½åŠ 
            const endingDiv = document.createElement('div');
            endingDiv.className = 'scene';
            endingDiv.style.animationDelay = `${length * 0.5}s`;
            endingDiv.innerHTML = `
                <div style="text-align: center; margin-top: 40px; padding: 20px;">
                    <h3 style="color: #8B0000;">- å®Œ -</h3>
                    <p style="margin-top: 20px; opacity: 0.8;">ã‚ãªãŸã ã‘ã®ç‰©èªãŒå®Œæˆã—ã¾ã—ãŸ</p>
                    <button onclick="generateStory()" style="margin-top: 20px; padding: 10px 30px; background: #8B0000; color: white; border: none; border-radius: 25px; cursor: pointer;">
                        æ–°ã—ã„ç‰©èªã‚’ç”Ÿæˆ
                    </button>
                </div>
            `;
            viewer.appendChild(endingDiv);

            loading.classList.remove('active');
            viewer.classList.add('active');
        }

        // ç”»åƒåé›†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒ‡ãƒ¢ç‰ˆï¼‰
        class ImageCollector {
            constructor() {
                this.sources = [
                    'unsplash',
                    'pexels',
                    'pixabay'
                ];
            }

            async collectImages(query, mood) {
                // ãƒ‡ãƒ¢ç”¨ï¼šãƒ©ãƒ³ãƒ€ãƒ ã«ç”»åƒã‚’è¿”ã™
                return sampleImages.sort(() => Math.random() - 0.5);
            }
        }

        // ã‚¹ãƒˆãƒ¼ãƒªãƒ¼è‡ªå‹•ç”ŸæˆAIï¼ˆãƒ‡ãƒ¢ç‰ˆï¼‰
        class StoryAI {
            async generateText(genre, intensity, previousScenes) {
                // ãƒ‡ãƒ¢ç”¨ï¼šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰é¸æŠ
                const templates = [
                    "å½¼å¥³ã®ç³ã«æ˜ ã‚‹ç§ã¯ã€ã‚‚ã†æ˜¨æ—¥ã¾ã§ã®ç§ã§ã¯ãªã‹ã£ãŸã€‚",
                    "ç¦ã˜ã‚‰ã‚ŒãŸæœå®Ÿã»ã©ã€ç”˜ç¾ãªã‚‚ã®ã¯ãªã„ã€‚",
                    "è‚Œã¨è‚ŒãŒè§¦ã‚Œåˆã†ç¬é–“ã€ä¸–ç•ŒãŒæ­¢ã¾ã£ãŸã‚ˆã†ãªæ°—ãŒã—ãŸã€‚",
                    "ã“ã®é–¢ä¿‚ã«åå‰ã¯ãªã„ã€‚ãŸã ã€ãŠäº’ã„ã‚’æ±‚ã‚åˆã†ã ã‘ã€‚"
                ];
                return templates[Math.floor(Math.random() * templates.length)];
            }
        }

        // åˆæœŸåŒ–
        window.onload = function() {
            // å¹´é½¢ç¢ºèªï¼ˆå®Ÿè£…ã¯çœç•¥ï¼‰
            console.log('Forbidden Stories - åˆæœŸåŒ–å®Œäº†');
        };
    </script>
</body>
</html>
